<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>LDO Admin Panel</title>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Manrope', sans-serif; background: #f1f5f9; color: #0f172a; padding: 40px; }
        
        .container { max-width: 1200px; margin: 0 auto; }
        
        /* –•–µ–¥–µ—Ä –∏ –Ω–∞–≤–∏–≥–∞—Ü–∏—è */
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; }
        h1 { font-size: 2rem; margin: 0; }
        
        .admin-controls { display: flex; align-items: center; gap: 20px; }
        .logout-link { color: #dc2626; text-decoration: none; font-weight: 600; border: 1px solid #dc2626; padding: 8px 15px; border-radius: 6px; transition: 0.3s; }
        .logout-link:hover { background: #dc2626; color: white; }

        /* –ö–∞—Ä—Ç–æ—á–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ */
        .stats-bar { display: flex; gap: 15px; margin-bottom: 30px; }
        .stat-badge { background: white; padding: 10px 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); font-weight: 600; color: #64748b; }
        .stat-badge strong { color: #0f172a; font-size: 1.2rem; margin-left: 5px; }
        .stat-badge.alert { color: #dc2626; }
        .stat-badge.alert strong { color: #dc2626; }

        /* –¢–∞–±–ª–∏—Ü–∞ */
        .table-container { background: white; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
        table { width: 100%; border-collapse: collapse; }
        
        th, td { padding: 15px 20px; text-align: left; border-bottom: 1px solid #e2e8f0; vertical-align: top; }
        th { background: #f8fafc; font-weight: 700; color: #475569; font-size: 0.85rem; text-transform: uppercase; letter-spacing: 0.5px; }
        tr:last-child td { border-bottom: none; }
        
        /* –°—Ç–∞—Ç—É—Å—ã —Å—Ç—Ä–æ–∫ */
        tr.read { background-color: #ffffff; }
        tr.unread { background-color: #eff6ff; border-left: 4px solid #2563eb; } /* –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –Ω–æ–≤—ã—Ö */
        tr:hover { background-color: #f1f5f9; }

        /* –≠–ª–µ–º–µ–Ω—Ç—ã –≤–Ω—É—Ç—Ä–∏ —Ç–∞–±–ª–∏—Ü—ã */
        .date-time { font-size: 0.85rem; color: #94a3b8; }
        .sender-info { font-weight: 600; }
        .sender-contact { font-size: 0.9rem; color: #64748b; font-weight: 400; }
        
        .tag { 
            padding: 4px 10px; border-radius: 6px; font-size: 0.75rem; font-weight: 700; 
            background: #e0f2fe; color: #0369a1; text-transform: uppercase;
        }

        /* –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π */
        .actions { display: flex; gap: 10px; }
        .btn-action { 
            padding: 6px 12px; border-radius: 6px; text-decoration: none; font-size: 0.85rem; font-weight: 600; transition: 0.2s; display: inline-block;
        }
        .btn-check { background: #dcfce7; color: #166534; }
        .btn-check:hover { background: #bbf7d0; }
        
        .btn-new { background: #dbeafe; color: #1e40af; } /* –ö–Ω–æ–ø–∫–∞ "–û—Ç–º–µ—Ç–∏—Ç—å –Ω–æ–≤—ã–º" */
        .btn-new:hover { background: #bfdbfe; }

        .btn-del { background: #fee2e2; color: #991b1b; }
        .btn-del:hover { background: #fecaca; }

        /* –ü—É—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ */
        .empty-state { padding: 60px; text-align: center; color: #94a3b8; }
        .return-link { display: inline-block; margin-top: 20px; color: #2563eb; text-decoration: none; font-weight: 600; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>LDO Admin</h1>
        <div class="admin-controls">
            <a href="/logout" class="logout-link">–í—ã–π—Ç–∏</a>
        </div>
    </div>

    <div class="stats-bar">
        <div class="stat-badge">–í—Å–µ–≥–æ –∑–∞—è–≤–æ–∫: <strong>{{ total }}</strong></div>
        <div class="stat-badge {{ 'alert' if unread > 0 }}">–ù–æ–≤—ã—Ö: <strong>{{ unread }}</strong></div>
    </div>

    <div class="table-container">
        {% if messages %}
        <table>
            <thead>
                <tr>
                    <th>–°—Ç–∞—Ç—É—Å / –î–∞—Ç–∞</th>
                    <th>–û—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å</th>
                    <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                    <th>–°–æ–æ–±—â–µ–Ω–∏–µ</th>
                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                </tr>
            </thead>
            <tbody>
                {% for msg in messages %}
                <tr class="{{ 'read' if msg.is_read else 'unread' }}">
                    <td>
                        {% if not msg.is_read %}
                            <span style="color: #2563eb; font-weight: 800; font-size: 0.8rem;">‚óè NEW</span><br>
                        {% else %}
                            <span style="color: #94a3b8; font-size: 0.8rem;">‚úì Read</span><br>
                        {% endif %}
                        <span class="date-time">{{ msg.date.strftime('%d.%m %H:%M') }}</span>
                    </td>
                    <td>
                        <div class="sender-info">{{ msg.name }}</div>
                        <div class="sender-contact">{{ msg.contact }}</div>
                    </td>
                    <td><span class="tag">{{ msg.category }}</span></td>
                    <td style="max-width: 350px; line-height: 1.4;">{{ msg.message }}</td>
                    <td>
                        <div class="actions">
                            <a href="/toggle_read/{{ msg.id }}" class="btn-action {{ 'btn-new' if msg.is_read else 'btn-check' }}">
                                {{ '–°–¥–µ–ª–∞—Ç—å –Ω–æ–≤—ã–º' if msg.is_read else '‚úì –í –∞—Ä—Ö–∏–≤' }}
                            </a>
                            
                            <a href="/delete/{{ msg.id }}" class="btn-action btn-del" onclick="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É –∑–∞—è–≤–∫—É?');">
                                üóë
                            </a>
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <div class="empty-state">
            <h3>–ó–∞—è–≤–æ–∫ –ø–æ–∫–∞ –Ω–µ—Ç</h3>
            <p>–ù–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Å —Å–∞–π—Ç–∞ –±—É–¥—É—Ç –ø–æ—è–≤–ª—è—Ç—å—Å—è –∑–¥–µ—Å—å.</p>
        </div>
        {% endif %}
    </div>
    
    <a href="/" class="return-link">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å–∞–π—Ç–∞</a>
</div>

</body>
</html>